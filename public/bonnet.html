<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Favelas – Bonnets</title>

  <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="produit.css">
  <link rel="stylesheet" href="bonnet.css">
</head>
<body class="bonnets">
  <!-- Ciel étoilé -->
  <div class="sky-layer sky-gradient" aria-hidden="true">
    <div class="stars"></div>
    <div class="twinkles"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
  </div>

  <!-- Vagues -->
  <div class="waves-top" aria-hidden="true">
    <svg viewBox="0 0 1440 140" preserveAspectRatio="none">
      <defs>
        <linearGradient id="gradTop" class="waves-grad" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%"/><stop offset="100%"/>
        </linearGradient>
      </defs>
      <path class="wave-path" fill="url(#gradTop)" fill-opacity=".25"
        d="M0,40 C120,65 240,90 360,80 C480,70 600,25 720,35 C840,45 960,105 1080,105 C1200,105 1320,70 1440,50 L1440,0 L0,0 Z"/>
    </svg>
  </div>
  <div class="waves-bottom" aria-hidden="true">
    <svg viewBox="0 0 1440 160" preserveAspectRatio="none">
      <defs>
        <linearGradient id="gradBottom" class="waves-grad" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%"/><stop offset="100%"/>
        </linearGradient>
      </defs>
      <path class="wave-path" fill="url(#gradBottom)" fill-opacity=".35"
        d="M0,120 C180,140 300,110 420,120 C540,130 660,160 780,150 C900,140 1020,100 1140,105 C1260,110 1350,135 1440,120 L1440,160 L0,160 Z"/>
    </svg>
  </div>

  <header>
    <div class="filigrane">
      <img src="images/logofvls.png" alt="Logo Favelas">
    </div>
    <div class="sub">Découvrez nos <strong>produits</strong>.</div>
  </header>

  <main class="shell">
    <div id="grid" class="grid"></div>
    <div id="emptyState" class="empty" style="display:none">Rien à afficher.</div>
  </main>

  <!-- Contact -->
  <footer class="contact-footer" id="contact">
    <div class="contact-inner">
      <h2 class="contact-title">Contactez-nous</h2>
      <p class="contact-sub">Insta aou Snap, tsizo :</p>
      <div class="contact-actions">
        <a class="contact-btn ig" href="https://instagram.com/favelas_976" target="_blank" rel="noopener">
          <svg aria-hidden="true" viewBox="0 0 24 24" width="20" height="20">
            <path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm0 2a3 3 0 00-3 3v10a3 3 0 003 3h10a3 3 0 003-3V7a3 3 0 00-3-3H7zm5 3a5 5 0 110 10 5 5 0 010-10zm0 2.2a2.8 2.8 0 100 5.6 2.8 2.8 0 000-5.6zM18.4 6.2a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z" fill="currentColor"/>
          </svg>
          <span>@favelas_976</span>
        </a>

        <a class="contact-btn sc" href="https://www.snapchat.com/add/akiilian93" target="_blank" rel="noopener">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"
               width="20" height="20" fill="currentColor" aria-hidden="true" focusable="false">
            <path d="M15.943 11.526c-.111-.303-.323-.465-.564-.599a1 1 0 0 0-.123-.064l-.219-.111c-.752-.399-1.339-.902-1.746-1.498a3.4 3.4 0 0 1-.3-.531c-.034-.1-.032-.156-.008-.207a.3.3 0 0 1 .097-.1c.129-.086.262-.173.352-.231.162-.104.289-.187.371-.245.309-.216.525-.446.66-.702a1.4 1.4 0 0 0 .069-1.16c-.205-.538-.713-.872-1.329-.872a1.8 1.8 0 0 0-.487.065c.006-.368-.002-.757-.035-1.139-.116-1.344-.587-2.048-1.077-2.61a4.3 4.3 0 0 0-1.095-.881C9.764.216 8.92 0 7.999 0s-1.76.216-2.505.641c-.412.232-.782.53-1.097.883-.49.562-.96 1.267-1.077 2.61-.033.382-.04.772-.036 1.138a1.8 1.8 0 0 0-.487-.065c-.615 0-1.124.335-1.328.873a1.4 1.4 0 0 0 .067 1.161c.136.256.352.486.66.701.082.058.21.14.371.246l.339.221a.4.4 0 0 1 .109.11c.026.053.027.11-.012.217a3.4 3.4 0 0 1-.295.52c-.398.583-.968 1.077-1.696 1.472-.385.204-.786.34-.955.8-.128.348-.044.743.28 1.075q.18.189.409.31a4.4 4.4 0 0 0 1 .4.7.7 0 0 1 .202.09c.118.104.102.26.259.488q.12.178.296.3c.33.229.701.243 1.095.258.355.014.758.03 1.217.18.19.064.389.186.618.328.55.338 1.305.802 2.566.802 1.262 0 2.02-.466 2.576-.806.227-.14.424-.26.609-.321.46-.152.863-.168 1.218-.181.393-.015.764-.03 1.095-.258a1.14 1.14 0 0 0 .336-.368c.114-.192.11-.327.217-.42a.6.6 0 0 1 .19-.087 4.5 4.5 0 0 0 1.014-.404c.16-.087.306-.2.429-.336l.004-.005c.304-.325.38-.709.256-1.047m-1.121.602c-.684.378-1.139.337-1.493.565-.3.193-.122.61-.34.76-.269.186-1.061-.012-2.085.326-.845.279-1.384 1.082-2.903 1.082s-2.045-.801-2.904-1.084c-1.022-.338-1.816-.14-2.084-.325-.218-.15-.041-.568-.341-.761-.354-.228-.809-.187-1.492-.563-.436-.24-.189-.39-.044-.46 2.478-1.199 2.873-3.05 2.89-3.188.022-.166.045-.297-.138-.466-.177-.164-.962-.65-1.18-.802-.36-.252-.52-.503-.402-.812.082-.214.281-.295.49-.295a1 1 0 0 1 .197.022c.396.086.78.285 1.002.338q.04.01.082.011c.118 0 .16-.06.152-.195-.026-.433-.087-1.277-.019-2.066.094-1.084.444-1.622.859-2.097.2-.229 1.137-1.22 2.93-1.22 1.792 0 2.732.987 2.931 1.215.416.475.766 1.013.859 2.098.068.788.009 1.632-.019 2.065-.01.142.034.195.152.195a.4.4 0 0 0 .082-.01c.222-.054.607-.253 1.002-.338a1 1 0 0 1 .197-.023c.21 0 .409.082.49.295.117.309-.04.56-.401.812-.218.152-1.003.638-1.18.802-.184.169-.16.3-.139.466.018.14.413 1.991 2.89 3.189.147.073.394.222-.041.464"/>
          </svg>
          <span>@akiilian93</span>
        </a>
      </div>
    </div>
  </footer>

  <!-- Modal -->
  <div class="modal-wrap" id="modalWrap" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-head">
        <div class="modal-title" id="modalTitle">Détails du produit</div>
        <button class="x" id="closeModal">✕</button>
      </div>
      <div class="modal-body">
        <div class="big"><img id="modalImg" alt="" /></div>
        <div>
          <div class="title" id="modalName"></div>
          <div class="desc" id="modalDesc"></div> <!-- mini description -->
          <div class="price" id="modalPrice"></div>
          <div class="meta" id="modalMeta"></div>

          <div class="field">
            <div class="label">Tailles disponibles</div>
            <div class="sizes" id="sizeChips"></div>
          </div>

          <div class="field">
            <div class="label">Couleurs</div>
            <div class="swatches" id="modalSwatches"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- Données : BONNETS UNIQUEMENT
    const PRODUCTS = [
      {
        id:"bn-001",
        name:"Bonnet Favelas",
        category:"bonnet",
        price:20.0,
        desc:"→ réfléchissant",                 // << mini description
        // ordre mis à jour : JAUNE d'abord
        colors:["jaune","noir","orange","gris"],
        sizes:[], // pas de tailles
        imgs:[
          "images/bonnetjaune3.png",   // jaune (1er)
          "images/bonnetnoire2.png",   // noir
          "images/bonnetorange2.png",  // orange
          "images/bonnetgris2.png"     // gris
        ]
      }
    ];

    const fmt = n => new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(n);
    const clamp = (n,min,max)=> Math.max(min, Math.min(max,n));

    let favorites = new Set(JSON.parse(localStorage.getItem("fav:products") || "[]"));
    let modalState = { id:null, size:null, color:null, imgIndex:0 };
    const galleryIndex = {};

    const grid = document.getElementById("grid");
    const emptyState = document.getElementById("emptyState");
    const modalWrap = document.getElementById("modalWrap");
    const closeModal = document.getElementById("closeModal");
    const modalImg = document.getElementById("modalImg");
    const modalName = document.getElementById("modalName");
    const modalDesc = document.getElementById("modalDesc");
    const modalPrice = document.getElementById("modalPrice");
    const modalMeta = document.getElementById("modalMeta");
    const sizeChips = document.getElementById("sizeChips");
    const modalSwatches = document.getElementById("modalSwatches");

    function labelForCat(){ return "Bonnet"; }
    function colorToHex(c){
      const map={ noir:"#111", blanc:"#fff", bleu:"#2f6bff", violet:"#8a53ff", vert:"#39d98a", jaune:"#ffd447", orange:"#ff7a29", gris:"#9aa0a6" };
      return map[c] || "#888";
    }

    // Carte produit (desc + pastilles)
    function cardTemplate(p){
      const isFav = favorites.has(p.id);
      const idx = galleryIndex[p.id] ?? 0;

      const colorDots = (p.colors||[]).map((c,i) =>
        `<span class="sw" data-idx="${i}" title="${c}" style="background:${colorToHex(c)}"></span>`
      ).join("");

      return `
        <article class="card" data-id="${p.id}">
          <div class="thumb" data-id="${p.id}">
            <img src="${p.imgs[idx]}" alt="${p.name}" loading="lazy" />
            <span class="badge">${labelForCat()}</span>
            <button class="heart ${isFav ? "active" : ""}" data-id="${p.id}" aria-label="${isFav ? "Retirer des favoris" : "Ajouter aux favoris"}" title="${isFav ? "Retirer des favoris" : "Ajouter aux favoris"}">♥</button>
          </div>
          <div class="body">
            <div class="title">${p.name}</div>
            <div class="desc small">${p.desc || ""}</div>
            <div class="price">${fmt(p.price)}</div>
            <div class="swatches">${colorDots}</div>
            <div class="actions">
              <button class="btn open">Détails</button>
            </div>
          </div>
        </article>
      `;
    }

    function render(){
      const list = [...PRODUCTS];
      grid.innerHTML = list.map(cardTemplate).join("");
      emptyState.style.display = list.length ? "none" : "block";

      grid.querySelectorAll(".open").forEach(btn=>{
        btn.addEventListener("click", (e)=>{
          const card = e.target.closest(".card");
          openModal(card.dataset.id);
        });
      });

      grid.querySelectorAll(".heart").forEach(btn=>{
        btn.addEventListener("click", (e)=>{
          e.stopPropagation();
          const id = btn.dataset.id;
          if(favorites.has(id)) favorites.delete(id); else favorites.add(id);
          localStorage.setItem("fav:products", JSON.stringify(Array.from(favorites)));
          btn.classList.toggle("active", favorites.has(id));
        });
      });

      grid.querySelectorAll(".card").forEach(card=>{
        const id = card.dataset.id;
        const thumb = card.querySelector(".thumb");
        const img = thumb.querySelector("img");
        card.querySelectorAll(".swatches .sw").forEach(sw=>{
          sw.addEventListener("click", ()=>{
            const i = Number(sw.dataset.idx);
            galleryIndex[id] = i;
            const p = PRODUCTS.find(x=>x.id===id);
            img.src = p.imgs[i] || p.imgs[0];
          });
        });
      });

      grid.querySelectorAll(".thumb").forEach(thumb=>{
        const id = thumb.dataset.id;
        let startX = null;
        function show(idx){
          const p = PRODUCTS.find(x=>x.id===id);
          if(!p) return;
          const newIdx = clamp(idx, 0, p.imgs.length-1);
          galleryIndex[id] = newIdx;
          thumb.querySelector("img").src = p.imgs[newIdx];
        }
        thumb.addEventListener("click", (e)=>{
          if(e.target.closest(".heart")) return;
          const rect = thumb.getBoundingClientRect();
          const half = rect.left + rect.width/2;
          const curr = galleryIndex[id] ?? 0;
          show(e.clientX < half ? curr - 1 : curr + 1);
        }, {passive:true});
        thumb.addEventListener("wheel", (e)=>{
          e.preventDefault();
          const curr = galleryIndex[id] ?? 0;
          show(e.deltaY > 0 ? curr + 1 : curr - 1);
        }, {passive:false});
        thumb.addEventListener("touchstart", (e)=>{ startX = e.touches[0].clientX; }, {passive:true});
        thumb.addEventListener("touchend", (e)=>{
          if(startX===null) return;
          const dx = e.changedTouches[0].clientX - startX;
          const curr = galleryIndex[id] ?? 0;
          if(Math.abs(dx) > 30) show(dx < 0 ? curr + 1 : curr - 1);
          startX = null;
        }, {passive:true});
      });
    }

    function openModal(id){
      const p = PRODUCTS.find(x=>x.id===id);
      if(!p) return;
      const currentIdx = galleryIndex[id] ?? 0;
      const hasSizes = Array.isArray(p.sizes) && p.sizes.length > 0;

      modalState = {
        id: p.id,
        size: hasSizes ? (p.sizes[0] || null) : null,
        color: p.colors[currentIdx] || p.colors[0] || null,
        imgIndex: currentIdx
      };

      modalImg.src = p.imgs[currentIdx];
      modalName.textContent = p.name;
      modalDesc.textContent = p.desc || "";
      modalDesc.style.display = p.desc ? "" : "none";
      modalPrice.textContent = fmt(p.price);
      modalMeta.textContent = `Couleurs: ${p.colors.join(" / ")}`;

      const sizeField = sizeChips.parentElement;
      if(!hasSizes){ sizeField.style.display = "none"; sizeChips.innerHTML = ""; }
      else{
        sizeField.style.display = "";
        sizeChips.innerHTML = p.sizes.map(s => `<button class="chip ${s===modalState.size?"active":""}" data-size="${s}">${s}</button>`).join("");
        sizeChips.querySelectorAll(".chip").forEach(ch=>{
          ch.addEventListener("click", ()=>{
            sizeChips.querySelectorAll(".chip").forEach(c=>c.classList.remove("active"));
            ch.classList.add("active");
            modalState.size = ch.dataset.size;
          });
        });
      }

      modalSwatches.innerHTML = p.colors.map((c,i) => `
        <span class="sw" data-idx="${i}" data-color="${c}" title="${c}"
              style="width:22px;height:22px;cursor:pointer;background:${colorToHex(c)};border:2px solid #ffffff44"></span>
      `).join("");
      modalSwatches.querySelectorAll(".sw").forEach(sw=>{
        sw.addEventListener("click", ()=>{
          modalSwatches.querySelectorAll(".sw").forEach(s=>s.style.outline="1px solid #0000");
          sw.style.outline="2px solid #fff8";
          const i = Number(sw.dataset.idx);
          modalState.color = sw.dataset.color;
          modalState.imgIndex = i;
          modalImg.src = p.imgs[i] || p.imgs[0];
        });
      });

      const currentSw = modalSwatches.querySelector(`.sw[data-idx="${currentIdx}"]`) || modalSwatches.querySelector(".sw");
      if(currentSw){ currentSw.click(); }

      modalWrap.style.display = "grid";
      modalWrap.setAttribute("aria-hidden","false");
    }

    function close(){ modalWrap.style.display = "none"; modalWrap.setAttribute("aria-hidden","true"); }
    closeModal.addEventListener("click", close);
    modalWrap.addEventListener("click", (e)=>{ if(e.target===modalWrap) close(); });

    render();
  </script>
</body>
</html>
